'use strict';function e(e){return e&&'object'==typeof e&&'default'in e?e.default:e}function t(e,t,n){var r=[f.step.run({fn:function(e){return t(e)}})];if(n){var u=f.createNode({node:r}),o=e.graphite.id,a=n.additionalLinks,c=a[o]||[];return a[o]=c,c.push(u),function(){var e=c.indexOf(u);-1!==e&&c.splice(e,1),f.clearNode(u)}}var i=f.createNode({node:r,parent:[e],family:{owners:e}});return function(){f.clearNode(i)}}function n(e,t){return t.displayName=e,t}function r(e,n){f.is.store(e)||p('expect useStore argument to be a store');var r=d(e,n),u=y(),o=l.useRef({store:e,value:r,pending:0});return v((function(){var r=t(e,(function(e){var t=o.current;t.pending||(t.value=e,t.pending=1,u(),t.pending=0)}),n),a=d(e,n),c=o.current;return c.store===e&&c.value!==a&&(c.value=a,c.pending=1,u(),c.pending=0),c.store=e,r}),[e,n]),r}function u(e,n){var r,u,a,c=e[0],i=e[1],s=m;i?(r=i,u=c,a=[]):(r=c.fn,u=c.store,a=c.keys,s=c.updateFilter||m),f.is.store(u)||p('useStoreMap expects a store'),Array.isArray(a)||p('useStoreMap expects an array as keys'),'function'!=typeof r&&p('useStoreMap expects a function');var x=l.useRef({}),g=x.current;g.fn=r,g.upd=s,g.init=g.store===u,g.store=u,g.active=1,v((function(){return function(){x.current&&(x.current.active=0)}}),[]);var k=y(),h=[n].concat(a),S=l.useMemo((function(){return o(d(u,n),a,x.current),t(u,(function(e){return o(e,a,x.current,k)}),n)}),h);return v((function(){return function(){return S()}}),h),g.val}function o(e,t,n,r){var u=n.fn(e,t);n.init?void 0!==u&&m(u,n.val)&&n.upd(u,n.val)&&(n.val=u,r&&n.active&&r()):(n.val=u,n.init=1)}function a(e){return r(e)}function c(e,t){function r(e){var n=l.useRef(e),r=a(u);v((function(){return c({props:n.current,state:u.getState()}),function(){i({props:n.current,state:u.getState()})}}),[]);var o=t(e,r);return n.current=e,o}var u;f.is.store(e)?u=e:'object'==typeof e&&null!==e?u=f.combine(e):p('shape should be a store or object with stores');var o='Unknown';u&&u.shortName&&(o=u.shortName);var c=f.createEvent(),i=f.createEvent();return r.mounted=c,r.unmounted=i,n(o+".View",r)}function i(e,t){void 0===t&&(t={});var n=l.useRef({value:null,count:0});v((function(){return e.open(n.current.value),function(){return e.close(n.current.value)}}),[e]),function(e,t){if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return 0;for(var u=0;u<n.length;u++){var o=n[u];if(e[o]!==t[o])return 0}return 1}return 0}(n.current.value,t)||(n.current.value=t,n.current.count+=1),v((function(){e.set(n.current.value)}),[n.current.count])}Object.defineProperty(exports,'__esModule',{value:1});var s=require('react'),f=require('effector/compat'),l=e(s),v='undefined'!=typeof window?l.useLayoutEffect:l.useEffect,p=function(e){throw Error(e)},d=function(e,t){return t?t.getState(e):e.getState()},m=function(e,t){return e!==t},y=function(){return l.useReducer((function(e){return e+1}),0)[1]},x=function(e){return console.error(e+" is deprecated")},g=function(e){return function(t){var r=e;return'function'!=typeof e&&(r=t,t=e),n("Connect("+(r.displayName||r.name||'Unknown')+")",(function(e){return l.createElement(r,Object.assign({},e,a(t)))}))}};exports.connect=g,exports.createComponent=c,exports.createContextComponent=function(e,t,r){return x('createContextComponent'),n((e.shortName||'Unknown')+".ContextComponent",(function(n){var u=l.useContext(t),o=a(e);return r(n,o,u)}))},exports.createGate=function(e,t){var r;return void 0===e&&(e='gate'),void 0===t&&(t={}),'object'==typeof e&&null!==e&&('defaultState'in e&&(t=e.defaultState),e.domain&&(r=e.domain),e=e.name),function(e){function t(e){return a(t,e),null}var r=e.name,u=e.domain,o=e.defaultState,a=e.hook,c=(u?u.compositeName.fullName+"/":'')+(void 0===r?'gate':r),i=f.createEvent(c+".set"),s=f.createEvent(c+".open"),l=f.createEvent(c+".close"),v=f.createStore(Boolean(0),{name:c+".status"}).on(s,(function(){return Boolean(1)})).on(l,(function(){return Boolean(0)})),p=f.createStore(o,{name:c+".state"}).on(i,(function(e,t){return t})).reset(l);if(u){var d=u.hooks;f.launch({target:[d.store,d.store,d.event,d.event,d.event],params:[v,p,s,l,i]})}return t.open=s,t.close=l,t.status=v,t.state=p,t.set=i,n("Gate:"+c,t)}({name:e,domain:r,defaultState:t,hook:i})},exports.createReactState=function(e,t){return x('createReactState'),g(t)(e)},exports.createStoreConsumer=function(e){return c(e,(function(e,t){return(0,e.children)(t)}))},exports.useEvent=function(e){return e},exports.useGate=i,exports.useList=function(e,t){return function(e,t,o){var a,c,i=[];'object'==typeof t&&null!==t?(t.keys&&(i=t.keys),a=t.fn,t.getKey&&(c=t.getKey)):a=t,f.is.store(e)||p('expect useList first argument to be a store'),'function'!=typeof a&&p("expect useList's renderItem to be a function"),Array.isArray(i)||p("expect useList's keys to be an array");var s=l.useMemo((function(){var t=n((e.shortName||'Unknown')+".Item",(function(t){var n=t.index,r=t.keys;if(v.current[1])return v.current[0](t.value,t.keyVal);var a=u([{store:e,keys:[n].concat(r),fn:function(e,t){return e[t[0]]}}],o);return v.current[0](a,n)}));return l.memo(t)}),[e,o,!!c]),v=l.useRef([a,c]);v.current=[a,c];var d=l.useMemo((function(){return i}),i);if(c)return r(e,o).map((function(e){var t=v.current[1](e);return l.createElement(s,{keyVal:t,key:t,keys:d,value:e})}));var m=u([{store:e,keys:[e],fn:function(e){return e.length}}],o);return Array.from({length:m},(function(e,t){return l.createElement(s,{index:t,key:t,keys:d})}))}(e,t)},exports.useStore=a,exports.useStoreMap=function(e,t){return u([e,t])};
//# sourceMappingURL=compat.js.map
