{"ast":null,"code":"import { createStore, createEffect, createEvent } from 'effector';\nexport const loadUsers = createEffect(async () => {\n  const req = await fetch('https://jsonplaceholder.typicode.com/users');\n  if (req.ok) return req.json();else return [];\n});\nexport const findUser = createEvent();\nexport const addUser = createEvent();\nexport const logOut = createEvent(); // @ts-ignore\n\nexport const $users = createStore({\n  userList: [],\n  currentUser: {\n    name: ''\n  },\n  isLogged: false,\n  loginError: false\n}).on(loadUsers.doneData, (state, payload) => {\n  state.userList = payload;\n}).on(findUser, (state, newUser) => {\n  // @ts-ignore\n  if (state.userList.find(user => user.name === newUser.name)) {\n    state.currentUser = newUser;\n    state.isLogged = true;\n    state.loginError = false;\n  } else state.loginError = true;\n}).on(addUser, (state, newUser) => {\n  // @ts-ignore\n  state.userList = [...state.userList, newUser];\n  state.currentUser = newUser;\n  state.isLogged = true;\n  state.loginError = false;\n}).reset(logOut);","map":{"version":3,"sources":["/Users/s.shakirova/Desktop/GitHub/device/src/model/users.ts"],"names":["createStore","createEffect","createEvent","loadUsers","req","fetch","ok","json","findUser","addUser","logOut","$users","userList","currentUser","name","isLogged","loginError","on","doneData","state","payload","newUser","find","user","reset"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,YAAtB,EAAoCC,WAApC,QAAuD,UAAvD;AASA,OAAO,MAAMC,SAAS,GAAGF,YAAY,CAAC,YAAY;AAChD,QAAMG,GAAG,GAAG,MAAMC,KAAK,CAAC,4CAAD,CAAvB;AACA,MAAID,GAAG,CAACE,EAAR,EAAY,OAAOF,GAAG,CAACG,IAAJ,EAAP,CAAZ,KACK,OAAO,EAAP;AACN,CAJoC,CAA9B;AAMP,OAAO,MAAMC,QAAQ,GAAGN,WAAW,EAA5B;AACP,OAAO,MAAMO,OAAO,GAAGP,WAAW,EAA3B;AACP,OAAO,MAAMQ,MAAM,GAAGR,WAAW,EAA1B,C,CAEP;;AACA,OAAO,MAAMS,MAAM,GAAGX,WAAW,CAAC;AAChCY,EAAAA,QAAQ,EAAE,EADsB;AAEhCC,EAAAA,WAAW,EAAE;AACXC,IAAAA,IAAI,EAAE;AADK,GAFmB;AAKhCC,EAAAA,QAAQ,EAAE,KALsB;AAMhCC,EAAAA,UAAU,EAAE;AANoB,CAAD,CAAX,CAQnBC,EARmB,CAQhBd,SAAS,CAACe,QARM,EAQI,CAACC,KAAD,EAAQC,OAAR,KAAoB;AAC1CD,EAAAA,KAAK,CAACP,QAAN,GAAiBQ,OAAjB;AACD,CAVmB,EAWnBH,EAXmB,CAWhBT,QAXgB,EAWN,CAACW,KAAD,EAAQE,OAAR,KAAoB;AAChC;AACA,MAAIF,KAAK,CAACP,QAAN,CAAeU,IAAf,CAAqBC,IAAD,IAAUA,IAAI,CAACT,IAAL,KAAcO,OAAO,CAACP,IAApD,CAAJ,EAA+D;AAC7DK,IAAAA,KAAK,CAACN,WAAN,GAAoBQ,OAApB;AACAF,IAAAA,KAAK,CAACJ,QAAN,GAAiB,IAAjB;AACAI,IAAAA,KAAK,CAACH,UAAN,GAAmB,KAAnB;AACD,GAJD,MAIOG,KAAK,CAACH,UAAN,GAAmB,IAAnB;AACR,CAlBmB,EAmBnBC,EAnBmB,CAmBhBR,OAnBgB,EAmBP,CAACU,KAAD,EAAQE,OAAR,KAAoB;AAC/B;AACAF,EAAAA,KAAK,CAACP,QAAN,GAAiB,CAAC,GAAGO,KAAK,CAACP,QAAV,EAAoBS,OAApB,CAAjB;AACAF,EAAAA,KAAK,CAACN,WAAN,GAAoBQ,OAApB;AACAF,EAAAA,KAAK,CAACJ,QAAN,GAAiB,IAAjB;AACAI,EAAAA,KAAK,CAACH,UAAN,GAAmB,KAAnB;AACD,CAzBmB,EA0BnBQ,KA1BmB,CA0Bbd,MA1Ba,CAAf","sourcesContent":["import { createStore, createEffect, createEvent } from 'effector';\n\nexport interface IUser {\n  name: string;\n  password: string;\n  email?: string;\n  phone?: string;\n}\n\nexport const loadUsers = createEffect(async () => {\n  const req = await fetch('https://jsonplaceholder.typicode.com/users');\n  if (req.ok) return req.json();\n  else return [];\n});\n\nexport const findUser = createEvent<IUser>();\nexport const addUser = createEvent<IUser>();\nexport const logOut = createEvent();\n\n// @ts-ignore\nexport const $users = createStore({\n  userList: [],\n  currentUser: {\n    name: ''\n  },\n  isLogged: false,\n  loginError: false\n})\n  .on(loadUsers.doneData, (state, payload) => {\n    state.userList = payload;\n  })\n  .on(findUser, (state, newUser) => {\n    // @ts-ignore\n    if (state.userList.find((user) => user.name === newUser.name)) {\n      state.currentUser = newUser;\n      state.isLogged = true;\n      state.loginError = false;\n    } else state.loginError = true;\n  })\n  .on(addUser, (state, newUser) => {\n    // @ts-ignore\n    state.userList = [...state.userList, newUser];\n    state.currentUser = newUser;\n    state.isLogged = true;\n    state.loginError = false;\n  })\n  .reset(logOut);\n"]},"metadata":{},"sourceType":"module"}